



<!DOCTYPE html>



<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Running simulations &mdash; HBP Neuromorphic Computing Platform Guidebook (WIP)</title>
    
    <link rel="stylesheet" href="_static/hbpdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/extra.js"></script>
    <script type="text/javascript" src="_static/hbpdoc.js"></script>
    <link rel="top" title="HBP Neuromorphic Computing Platform Guidebook (WIP)" href="index.html" />
    <link rel="next" title="The BrainScaleS “physical model” system" href="pm/pm.html" />
    <link rel="prev" title="Building models" href="building_models.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">

  </head>
  <body>
<div class="hbpdoc-page">
    <section class="hbpdoc-title page-header">
        <a class="project-title" href="index.html">HBP Neuromorphic Computing Platform Guidebook</a>

        <a class="hbpdoc-toc-toggle pull-right" href>
            <span class="zmdi zmdi-menu"></span> <span class="sr-only icon-text">Menu</span>
        </a>
    </section>
    <section class="hbpdoc-main">
        <nav class="hbpdoc-sidebar hbpdoc-container">
            <a class="hbpdoc-toc-toggle pull-right" href>
                <span class="zmdi zmdi-menu"></span> <span class="sr-only icon-text">Menu</span>
            </a>
            
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/HBP_Primary_RGB_logoOnlyScaled68px.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Running simulations</a><ul>
<li><a class="reference internal" href="#format-of-a-job">Format of a job</a><ul>
<li><a class="reference internal" href="#experiment-description">Experiment description</a></li>
<li><a class="reference internal" href="#input-data">Input data</a></li>
<li><a class="reference internal" href="#hardware-platform-configuration">Hardware platform configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-the-web-interface">Using the web interface</a><ul>
<li><a class="reference internal" href="#setting-up-your-collab">Setting up your Collab</a></li>
<li><a class="reference internal" href="#requesting-access-to-the-platform">Requesting access to the platform</a></li>
<li><a class="reference internal" href="#submitting-a-simulation-job">Submitting a simulation job</a></li>
<li><a class="reference internal" href="#retrieving-the-results-of-a-job">Retrieving the results of a job</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-the-python-client">Using the Python client</a><ul>
<li><a class="reference internal" href="#installing-the-python-client">Installing the Python client</a></li>
<li><a class="reference internal" href="#configuring-the-client">Configuring the client</a></li>
<li><a class="reference internal" href="#submitting-a-job">Submitting a job</a></li>
<li><a class="reference internal" href="#monitoring-job-status">Monitoring job status</a></li>
<li><a class="reference internal" href="#id2">Retrieving the results of a job</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="building_models.html"
                        title="previous chapter">Building models</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="pm/pm.html"
                        title="next chapter">The BrainScaleS &#8220;physical model&#8221; system</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/using_the_platform.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        </nav>

        <article class="hbpdoc-content">

            <div class="content">
                

                <aside class="hbpdoc-hnav hbpdoc-hnav-top">
                    
                    <span class="hbpdoc-hnav-previous">
                        previous: <a class="hbpdoc-hnav-link" href="building_models.html">Building models</a>
                    </span>
                    
                    
                    <span class="hbpdoc-hnav-next">
                        next: <a class="hbpdoc-hnav-link" href="pm/pm.html">The BrainScaleS &#8220;physical model&#8221; system</a>
                    </span>
                    
                </aside>

                <div class="section" id="running-simulations">
<h1>Running simulations<a class="headerlink" href="#running-simulations" title="Permalink to this headline">¶</a></h1>
<p>The Neuromorphic Computing Platform of the <a class="reference external" href="http://www.humanbrainproject.eu">Human Brain Project</a> contains two very different neuromorphic hardware
systems - BrainScaleS (also known as &#8220;NM-PM-1&#8221;, &#8220;physical model&#8221;) and SpiNNaker (also known as &#8220;NM-MC-1&#8221;, &#8220;many core&#8221;) - but has a single interface.</p>
<p>Jobs are written as Python scripts using the PyNN API, submitted to a queue server, then executed on one of the
neuromorphic systems. On job completion, the user may retrieve the results of the simulation/emulation.</p>
<p>There are several ways of interacting with the queue server. This document describes the web interface and the Python
client.</p>
<div class="section" id="format-of-a-job">
<h2>Format of a job<a class="headerlink" href="#format-of-a-job" title="Permalink to this headline">¶</a></h2>
<p>Whether using the web interface or the Python client, a job for the HBP Neuromorphic Computing
Platform consists of:</p>
<ul class="simple">
<li>an experiment description</li>
<li>input data</li>
<li>hardware platform configuration</li>
</ul>
<div class="section" id="experiment-description">
<h3>Experiment description<a class="headerlink" href="#experiment-description" title="Permalink to this headline">¶</a></h3>
<p>The experiment description takes the form of a Python script using the PyNN API. You must provide one of:</p>
<ul class="simple">
<li>a single script, uploaded as part of the job submission or pasted into the web form</li>
<li>the file path of a single script located on your local machine (Python client only)</li>
<li>the URL of a public Git repository</li>
<li>the URL of a zip or tar.gz archive</li>
</ul>
<p>In the latter two cases, you may optionally specify the path to the main Python script you wish
to run, together with any command-line arguments. The command-line arguments may contain a
placeholder, &#8220;<tt class="docutils literal"><span class="pre">{system}</span></tt>&#8221;, which will be replaced with the name of the PyNN backend module
to be used (e.g. &#8220;spinnaker&#8221;). Example:</p>
<div class="highlight-python"><pre>main.py --option1=42 {system}</pre>
</div>
<p>If the path is not specified, the script is assumed to be named <tt class="file docutils literal"><span class="pre">run.py</span></tt>,
i.e. the default is:</p>
<div class="highlight-python"><pre>run.py {system}</pre>
</div>
</div>
<div class="section" id="input-data">
<h3>Input data<a class="headerlink" href="#input-data" title="Permalink to this headline">¶</a></h3>
<p>Input data are specified as a list of data items. Each data item is the URL of a data file that should be downloaded
and placed in the job working directory. If your input data files are contained within your Git repository or zip
archive, you do not need to specify them here.</p>
</div>
<div class="section" id="hardware-platform-configuration">
<h3>Hardware platform configuration<a class="headerlink" href="#hardware-platform-configuration" title="Permalink to this headline">¶</a></h3>
<p>Here you must choose the hardware system to be used (&#8220;BrainScaleS&#8221; for the Heidelberg system,
&#8220;SpiNNaker&#8221; for the Manchester system, &#8220;BrainScaleS-ESS&#8221; for the software simulator of the BrainScaleS system,
or &#8220;Spikey&#8221; for the Heidelberg single-chip system) and specify any
specific configuration options for the hardware system you have chosen.</p>
</div>
</div>
<div class="section" id="using-the-web-interface">
<span id="id1"></span><h2>Using the web interface<a class="headerlink" href="#using-the-web-interface" title="Permalink to this headline">¶</a></h2>
<div class="section" id="setting-up-your-collab">
<h3>Setting up your Collab<a class="headerlink" href="#setting-up-your-collab" title="Permalink to this headline">¶</a></h3>
<p>The neuromorphic computing platform can be accessed from within the HBP Collaboratory using the
&#8220;Neuromorphic Computing Platform Job Manager v2&#8221; app and the &#8220;Neuromorphic Computing Platform Resource Manager&#8221; app.</p>
<p>To create a new Collab which already contains these two apps,
go to the <a class="reference external" href="https://collab.humanbrainproject.eu/#/collab/51/nav/244">Neuromorphic Computing Platform collab</a> and click on <em class="guilabel">Create a Collab</em> or
<em class="guilabel">Get Started!</em> To add the apps to an existing Collab, click <em class="guilabel">ADD</em> in the
Navigation panel, and then select each of the apps in the list.</p>
</div>
<div class="section" id="requesting-access-to-the-platform">
<span id="access-requests"></span><h3>Requesting access to the platform<a class="headerlink" href="#requesting-access-to-the-platform" title="Permalink to this headline">¶</a></h3>
<p>In your Collab, click on <em class="guilabel">Resource Manager</em>, and fill in the form.</p>
<img alt="_images/resource_request_form.png" class="align-center" src="_images/resource_request_form.png" style="width: 70%;" />
<p>The project description should contain a scientific or technical motivation for using the platform,
and should specify which of the Neuromorphic Computing Systems (&#8220;BrainScaleS&#8221; and/or &#8220;SpiNNaker&#8221;)
you wish to use.</p>
<p>Two forms of access are available:</p>
<dl class="docutils">
<dt>Test/preparatory access</dt>
<dd>Only a short technical motivation is required. A fixed quota of 1 million core-hours
(for the SpiNNaker system) or 100 wafer-hours (for the BrainScaleS system) will be allocated,
subject to a brief technical review, together with temporary storage of 100 GB.</dd>
<dt>Project access</dt>
<dd>For projects requiring more than the test/preparatory quotas, a scientific motivation of about
one page should be provided, and a request for resources (in core-hours, wafer-hours
and/or GB of storage) should be specified, and justified with respect to the project&#8217;s
scientific goals. This proposal will receive both scientific and technical reviews.</dd>
</dl>
<p>Access is granted on a per-collab basis, not per-person. All members of a collab will be able to make use of the quota.
All collab members will also be asked to sign and return a User Agreement form.</p>
<p>Once the resource request is granted, the :guilabel&#8217;:<cite>Resource Manager</cite> will display the
quota usage.</p>
</div>
<div class="section" id="submitting-a-simulation-job">
<h3>Submitting a simulation job<a class="headerlink" href="#submitting-a-simulation-job" title="Permalink to this headline">¶</a></h3>
<p>To submit a simulation job to the Platform, click on <em class="guilabel">Job Manager</em>.</p>
<p>You will see a list of jobs you have submitted to the platform.
The first time you connect, of course, this list will be empty.</p>
<p>To create a new simulation job click on the <em class="guilabel">&#8216;+&#8217;</em> icon or the <em class="guilabel">New Job</em> button.</p>
<p>In this dialog, you must choose the project with which the job is associated, the hardware
platform on which you wish to run (&#8220;BrainScaleS&#8221;, &#8220;SpiNNaker&#8221;, &#8220;BrainScaleS-ESS&#8221; or &#8220;Spikey&#8221;), and provide the Python script which
should be run, either by copy-and-pasting the script into the &#8220;Code&#8221; box,</p>
<img alt="_images/create_job.png" class="align-center" src="_images/create_job.png" style="width: 70%;" />
<p>or by giving the URL of a version control repository or zip/tar archive together with a command-line
invocation.</p>
<img alt="_images/create_job_git.png" class="align-center" src="_images/create_job_git.png" style="width: 70%;" />
<p>In your Python script you should avoid hard-coding the name of the PyNN backend to run, as
this will differ depending on the platform. Instead, your script should read the name of the
backend from the command-line. With PyNN 0.8, this can be achieved using:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyNN.utility</span> <span class="kn">import</span> <span class="n">get_simulator</span>
<span class="n">sim</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="n">get_simulator</span><span class="p">()</span>

<span class="n">sim</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>For PyNN 0.7, see <a class="reference internal" href="building_models.html#using-different-backends"><em>Using different backends</em></a>.</p>
<p>The &#8220;Hardware config&#8221; box is optional, but may contain extra configuration options in JSON
format (similar to the syntax for dictionaries in Python).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">more information on the available configuration options for the different hardware
systems will be provided soon.</p>
</div>
<p>It is possible to provide input data files to the simulation. The files must be accessible
online.</p>
<p>After clicking &#8220;Submit&#8221; the job will be submitted to the queue, and will appear in the list of
jobs with a &#8220;submitted&#8221; label.</p>
<img alt="_images/job_list.png" class="align-center" src="_images/job_list.png" style="width: 100%;" />
<p>You will receive e-mail notifications when the job starts running and when it completes.</p>
</div>
<div class="section" id="retrieving-the-results-of-a-job">
<h3>Retrieving the results of a job<a class="headerlink" href="#retrieving-the-results-of-a-job" title="Permalink to this headline">¶</a></h3>
<p>Once the job is completed, click on the magnifying glass icon to see the job results and
download the output data files.</p>
<img alt="_images/job_results.png" class="align-center" src="_images/job_results.png" style="width: 100%;" />
</div>
</div>
<div class="section" id="using-the-python-client">
<h2>Using the Python client<a class="headerlink" href="#using-the-python-client" title="Permalink to this headline">¶</a></h2>
<p>The Python client allows scripted access to the Platform. The same client software is used both by end users for
submitting jobs to the queue, and by the hardware systems to take jobs off the queue and to post the results.</p>
<div class="section" id="installing-the-python-client">
<h3>Installing the Python client<a class="headerlink" href="#installing-the-python-client" title="Permalink to this headline">¶</a></h3>
<p>Install the nmpi_client package from PyPI into a virtual environment, using for example
virtualenv or Anaconda. The client works with Python 2.7 and Python 3.3 or newer.</p>
<div class="highlight-python"><pre>$ pip install hbp_neuromorphic_platform</pre>
</div>
</div>
<div class="section" id="configuring-the-client">
<h3>Configuring the client<a class="headerlink" href="#configuring-the-client" title="Permalink to this headline">¶</a></h3>
<p>Before using the Neuromorphic Computing Platform you must have an HBP account, have created at
least one Collab, and have obtained a compute quota as described above under <a class="reference internal" href="#access-requests"><em>Requesting access to the platform</em></a>.</p>
<p>To interact with the Platform, you first create a <tt class="xref py py-class docutils literal"><span class="pre">Client</span></tt> object with your HBP username:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">nmpi</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">nmpi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="s">&quot;myusername&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will prompt you for your password.</p>
<p>After you have connected once with your password, the platform provides a token which you
can save to a file and use in place of the password.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">token</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">token</span>

<span class="n">new_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="s">&quot;myusername&quot;</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">token</span><span class="p">)</span>
</pre></div>
</div>
<p>This token will eventually expire. When it does, reconnect with your password to obtain a new token.</p>
</div>
<div class="section" id="submitting-a-job">
<h3>Submitting a job<a class="headerlink" href="#submitting-a-job" title="Permalink to this headline">¶</a></h3>
<p>Simple example: a single file on your local machine, no input data or parameter files.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">job_id</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">submit_job</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s">&quot;/Users/alice/dev/pyNN_0.7/examples/IF_cond_exp.py&quot;</span><span class="p">,</span>
                      <span class="n">platform</span><span class="o">=</span><span class="s">&quot;BrainScaleS&quot;</span><span class="p">,</span>
                      <span class="n">collab_id</span><span class="o">=</span><span class="mi">563</span><span class="p">)</span>
</pre></div>
</div>
<p>The Collab ID is the first number in the URL of your Collab, e.g. <tt class="docutils literal"><span class="pre">https://collab.humanbrainproject.eu/#/collab/563/nav/5043</span></tt>.</p>
<p>source, platform, collab_id, config=None, inputs=None command</p>
<p>A more complex example: the experiment and model description are contained in a Git repository. The input to the
network is an image file taken from the internet.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">job_id</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">submit_job</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s">&quot;https://github.com/apdavison/nmpi_test&quot;</span><span class="p">,</span>
                      <span class="n">platform</span><span class="o">=</span><span class="s">&quot;SpiNNaker&quot;</span><span class="p">,</span>
                      <span class="n">collab_id</span><span class="o">=</span><span class="mi">141</span><span class="p">,</span>
                      <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;http://aloi.science.uva.nl/www-images/90/90.jpg&quot;</span><span class="p">],</span>
                      <span class="n">command</span><span class="o">=</span><span class="s">&quot;run.py {system}&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="monitoring-job-status">
<h3>Monitoring job status<a class="headerlink" href="#monitoring-job-status" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">job_status</span><span class="p">(</span><span class="n">job_id</span><span class="p">)</span>
<span class="go">u&#39;submitted&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>Retrieving the results of a job<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">job</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_job</span><span class="p">(</span><span class="n">job_id</span><span class="p">,</span> <span class="n">with_log</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
<span class="go">{u&#39;code&#39;: u&#39;https://github.com/apdavison/nmpi_test&#39;,</span>
<span class="go"> u&#39;hardware_config&#39;: u&#39;&#39;,</span>
<span class="go"> u&#39;hardware_platform&#39;: u&#39;SpiNNaker&#39;,</span>
<span class="go"> u&#39;id&#39;: 19,</span>
<span class="go"> u&#39;input_data&#39;: [{u&#39;id&#39;: 34,</span>
<span class="go">                  u&#39;resource_uri&#39;: u&#39;/api/v1/dataitem/34&#39;,</span>
<span class="go">                  u&#39;url&#39;: u&#39;http://aloi.science.uva.nl/www-images/90/90.jpg&#39;}],</span>
<span class="go"> u&#39;log&#39;: u&#39;&#39;,</span>
<span class="go"> u&#39;output_data&#39;: [{u&#39;id&#39;: 35,</span>
<span class="go">                  u&#39;resource_uri&#39;: u&#39;/api/v1/dataitem/35&#39;,</span>
<span class="go">                  u&#39;url&#39;: u&#39;http://example.com/my_output_data.h5&#39;}],</span>
<span class="go"> u&#39;collab_id&#39;: 141,</span>
<span class="go"> u&#39;resource_uri&#39;: u&#39;/api/v1/queue/19&#39;,</span>
<span class="go"> u&#39;status&#39;: u&#39;finished&#39;,</span>
<span class="go"> u&#39;timestamp_completion&#39;: u&#39;2014-08-13T21:02:37.541732&#39;,</span>
<span class="go"> u&#39;timestamp_submission&#39;: u&#39;2014-08-13T19:40:43.964541&#39;,</span>
<span class="go"> u&#39;user&#39;: u&#39;myusername&#39;}</span>
</pre></div>
</div>
<p>To download the data files generated by your simulation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">filenames</span> <span class="o">=</span> <span class="n">download_data_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job</span><span class="p">,</span> <span class="n">local_dir</span><span class="o">=</span><span class="s">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>

            </div>

            <aside class="hbpdoc-hnav hbpdoc-hnav-bottom">
                
                <span class="hbpdoc-hnav-previous">
                    previous: <a class="hbpdoc-hnav-link" href="building_models.html">Building models</a>
                </span>
                
                
                <span class="hbpdoc-hnav-next">
                    next: <a class="hbpdoc-hnav-link" href="pm/pm.html">The BrainScaleS &#8220;physical model&#8221; system</a>
                </span>
                
            </aside>
        </article>
    </section>


    <div class="hbpdoc-footer">
        HBP Neuromorphic Computing Platform Guidebook <small>0.1</small> 
    <div class="footer">
        &copy; Copyright 2015, Andrew P. Davison, Eric Müller, Sebastian Schmitt, Bernhard Vogginger, David Lester, Thomas Pfeil, ....
      Last updated on Aug 17, 2016 (fda7c57, preliminary documentation).
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
    </div>
</div>

  </body>
</html>